<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Student Data Dashboard</title>

<!-- CSS Links -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  body { font-family: Arial, sans-serif; background: #f8f9fa; margin: 20px; color: #333; }
  h2 { color: #6C72FF; text-align: center; margin-bottom: 10px; }
  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  table, th, td { border: 1px solid #ccc; }
  th, td { padding: 10px; text-align: center; }
  #chart { height: 400px; margin-top: 30px; }
  #map { height: 400px; margin-top: 30px; border-radius: 12px; }
  #filterSection { text-align: center; margin: 20px 0; }
  #filterSection input, button { padding: 8px 10px; margin: 0 5px; border-radius: 5px; border: 1px solid #aaa; }
  #filterSection button { background: #6C72FF; color: white; cursor: pointer; }
  #mapOutput { margin-top: 20px; }
</style>
</head>
<body>

<h2>Student Data Dashboard</h2>

<!-- Main Table -->
<table id="studentTable" class="display">
  <thead>
    <tr>
      <th>Name</th>
      <th>City</th>
      <th>Grade</th>
      <th>Joined Date</th>
      <th>End Date</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<!-- Date Range Filter -->
<div id="filterSection">
  <h3>Filter Students by Date Range</h3>
  <label>From: <input type="date" id="startDate"></label>
  <label>To: <input type="date" id="endDate"></label>
  <button id="filterBtn">Filter</button>
  <button id="resetBtn">Reset</button>
</div>

<!-- Filtered Table -->
<table id="filteredTable">
  <thead>
    <tr>
      <th>Name</th>
      <th>City</th>
      <th>Grade</th>
      <th>Joined Date</th>
      <th>End Date</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<!-- ECharts -->
<div id="chart"></div>

<!-- Leaflet Map -->
<div id="map"></div>

<!-- JavaScript Map -->
<h3>JavaScript Map Example (Filtered Students)</h3>
<ul id="mapOutput"></ul>

<!-- JS Libraries -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
const students = [
  { name: "Niru", city: "Chennai", grade: 10, date: "2021-10-25", toDate: "2025-05-12" },
  { name: "Ravi Kumar", city: "Delhi", grade: 8, date: "2021-08-14", toDate: "2025-06-20" },
  { name: "Emily Smith", city: "Mumbai", grade: 10, date: "2021-08-14", toDate: "2025-06-20" },
  { name: "John Lee", city: "Kolkata", grade: 7, date: "2023-08-10", toDate: "2027-05-15" },
  { name: "Priya Sharma", city: "Bangalore", grade: 9, date: "2023-08-10", toDate: "2027-05-15" },
  { name: "Michael Brown", city: "Chennai", grade: 8, date: "2021-10-25", toDate: "2025-05-12" },
  { name: "Fatima Noor", city: "Delhi", grade: 10, date: "2019-09-18", toDate: "2023-06-15" },
  { name: "Karan Patel", city: "Mumbai", grade: 9, date: "2019-09-18", toDate: "2023-06-15" },
  { name: "Sophia Johnson", city: "Bangalore", grade: 8, date: "2024-07-01", toDate: "2028-05-15" },
  { name: "Daniel Wilson", city: "Hyderabad", grade: 9, date: "2024-07-01", toDate: "2028-05-15" },
  { name: "Aditi Rao", city: "Chennai", grade: 9, date: "2022-07-04", toDate: "2025-05-16" },
  { name: "Rahul Mehta", city: "Delhi", grade: 8, date: "2022-07-04", toDate: "2025-05-16" },
  { name: "Sneha Gupta", city: "Mumbai", grade: 7, date: "2022-07-04", toDate: "2025-05-16" },
  { name: "Liam Thomas", city: "Kolkata", grade: 10, date: "2024-10-08", toDate: "2027-10-13" },
  { name: "Olivia White", city: "Hyderabad", grade: 9, date: "2024-10-08", toDate: "2027-10-13" },
  { name: "Arjun Reddy", city: "Chennai", grade: 8, date: "2024-10-08", toDate: "2027-10-13" },
  { name: "Emma Davis", city: "Delhi", grade: 10, date: "2024-10-12", toDate: "2028-10-17" },
  { name: "Noah Scott", city: "Mumbai", grade: 9, date: "2024-10-12", toDate: "2028-10-17" },
  { name: "Ishaan Verma", city: "Bangalore", grade: 8, date: "2024-10-12", toDate: "2028-10-17" },
  { name: "Mia Patel", city: "Hyderabad", grade: 9, date: "2024-10-12", toDate: "2028-10-17" }
];

// ====== DataTable with Buttons ======
$(document).ready(() => {
  $('#studentTable').DataTable({
    data: students,
    columns: [
      { data: 'name' },
      { data: 'city' },
      { data: 'grade' },
      { data: 'date' },
      { data: 'toDate' }
    ],
    dom: 'Bfrtip',
    buttons: [
      { extend: 'copyHtml5', text: '📋 Copy' },
      { extend: 'excelHtml5', text: '📊 Excel' },
      { extend: 'csvHtml5', text: 'CSV' },
      { extend: 'pdfHtml5', text: '📄 PDF' },
      { extend: 'print', text: '🖨️ Print' }
    ]
  });
});

// ====== ECharts ======
const chartDom = document.getElementById('chart');
const myChart = echarts.init(chartDom);
function updateChart(data) {
  const option = {
    title: { text: 'Student Grades', left: 'center' },
    tooltip: { trigger: 'item' },
    xAxis: { type: 'category', data: data.map(s => s.name), axisLabel: { rotate: 45 } },
    yAxis: { type: 'value', name: 'Grade Points' },
    series: [{ name: 'Grade', type: 'bar', data: data.map(s => s.grade), itemStyle: { color: '#6C72FF' } }]
  };
  myChart.setOption(option);
}
updateChart(students);

// ====== Leaflet Map ======
const map = L.map('map').setView([20.5937, 78.9629], 5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

function updateMap(data) {
  map.eachLayer(layer => { if (layer instanceof L.CircleMarker) map.removeLayer(layer); });
  const cityCoords = {
    Chennai: [13.0827, 80.2707],
    Delhi: [28.6139, 77.209],
    Mumbai: [19.076, 72.8777],
    Bangalore: [12.9716, 77.5946],
    Kolkata: [22.5726, 88.3639],
    Hyderabad: [17.385, 78.4867]
  };
  data.forEach(student => {
    const coords = cityCoords[student.city];
    if (coords) {
      L.circleMarker(coords, { radius: 8, color: '#6C72FF' })
        .addTo(map)
        .bindPopup(`${student.name} (${student.city})`);
    }
  });
}
updateMap(students);

// ====== JavaScript Map ======
function updateJSMap(data) {
  const jsMapOutput = document.getElementById('mapOutput');
  jsMapOutput.innerHTML = '';
  data.forEach((student, i) => {
    const li = document.createElement('li');
    li.textContent = `${student.name} → Student ID: ${100 + i}`;
    jsMapOutput.appendChild(li);
  });
}
updateJSMap(students);

// ====== Date Range Filter ======
document.getElementById('filterBtn').addEventListener('click', () => {
  const start = document.getElementById('startDate').value;
  const end = document.getElementById('endDate').value;

  if (!start || !end) { alert("Please select both start and end dates!"); return; }

  const filtered = students.filter(s => s.date >= start && s.toDate <= end);
  const tbody = document.querySelector('#filteredTable tbody');
  tbody.innerHTML = '';

  if (filtered.length > 0) {
    filtered.forEach(s => {
      const row = `<tr><td>${s.name}</td><td>${s.city}</td><td>${s.grade}</td><td>${s.date}</td><td>${s.toDate}</td></tr>`;
      tbody.innerHTML += row;
    });
  } else {
    tbody.innerHTML = `<tr><td colspan="5">No students joined in this date range</td></tr>`;
  }

  updateChart(filtered);
  updateMap(filtered);
  updateJSMap(filtered);
});

// ====== Reset Filter ======
document.getElementById('resetBtn').addEventListener('click', () => {
  document.getElementById('startDate').value = '';
  document.getElementById('endDate').value = '';
  document.querySelector('#filteredTable tbody').innerHTML = '';
  updateChart(students);
  updateMap(students);
  updateJSMap(students);
});
</script>
</body>
</html>
